image: composer:2.0

stages:
  - build
  - test

composer:
  stage: build
  script:
    - composer self-update
    - composer install --no-interaction --dev

test:
  script:
    - vendor/bin/phpunit --testdox

lint:
  script:
    - composer global require "squizlabs/php_codesniffer=*"
    - phpcs --standard=PSR2 src/

cache:
  # We key the cache using the branch's unique identifier.
  key: ${CI_COMMIT_REF_SLUG}
  paths:
    - vendor/
